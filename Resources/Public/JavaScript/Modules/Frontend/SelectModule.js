define(["TYPO3/CMS/In2studyfinder/Vendor/select2","jquery"],function(e,u){"use strict";var r={identifiers:{select:".js-in2studyfinder-select2",quickSearchForm:".js-in2studyfinder-quick-search"},initialize:function(){if(document.querySelector(".js-in2studyfinder-quick-search")){this.updatePlaceholderLabel(),u(r.identifiers.select).select2({matcher:function(e,t){return e,r.matcher(e,t)},sorter:function(e){var t=e.slice(0);return t.sort(function(e,t){return e.text.toUpperCase()<t.text.toUpperCase()?-1:e.text.toUpperCase()>t.text.toUpperCase()?1:0}),t},allowClear:!1,placeholder:"select degree program or enter keyword",language:"de"}),this.redirectOnSelect()}},matcher:function(e,r){if(""===u.trim(e.term))return r;var t=r.text.toUpperCase(),n=e.term.toUpperCase(),i=r.element,a=u(i).attr("alt"),l=!1;if(void 0!==a&&""!==a){var c=a.split(",");u.each(c,function(e,t){t=t.trim(),(-1<r.text.toUpperCase().indexOf(n.toUpperCase())||-1<t.toUpperCase().indexOf(n.toUpperCase()))&&(l=!0)})}if(-1<t.indexOf(n)||!0===l)return r;if(r.children&&0<r.children.length){for(var d=u.extend(!0,{},r),s=r.children.length-1;0<=s;s--){var o=r.children[s];null===this.matcher(e,o)&&d.children.splice(s,1)}return 0<d.children.length?d:this.matcher(e,d)}return null},redirectOnSelect:function(){u(r.identifiers.select).on("select2:select",function(){var e=u(r.identifiers.select).select2("data")[0].element.dataset.url;e.length&&(window.location.href=e)})},updatePlaceholderLabel:function(){var e=u("html").attr("lang");"de"===e||"de-DE"===e?u(r.identifiers.select).attr("data-placeholder","Studiengang wÃ¤hlen oder Suchbegriff eingeben"):u(r.identifiers.select).attr("data-placeholder","Select degree program or enter keyword")}};return r});
