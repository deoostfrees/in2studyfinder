define(["TYPO3/CMS/In2studyfinder/Utility/UiUtility","TYPO3/CMS/In2studyfinder/Utility/AjaxUtility","TYPO3/CMS/In2studyfinder/Utility/UrlUtility"],function(n,t,r){"use strict";var o={coursesList:[],identifiers:{checkAllCheckbox:".js-in2studyfinder-check-all",paginationContainer:".js-in2studyfinder-pagebrowser",itemsPerPageSelect:".js-in2studyfinder-itemsPerPage",changeLanguageSelect:".js-in2studyfinder-recordLanguage",courseListTableBody:".js-in2studyfinder-course-list",loader:".in2js-in2studyfinder-loader",loaderActive:".in2js-in2studyfinder-loader--active"},initialize:function(){o.preparePagination(),o.prepareSelectedCourses(),o.addEventListener()},addEventListener:function(){document.querySelector(o.identifiers.checkAllCheckbox).addEventListener("click",o.toggleAllCoursesSelect),document.querySelector(o.identifiers.paginationContainer).addEventListener("click",o.callPagination),document.querySelector(o.identifiers.itemsPerPageSelect).onchange=function(e){o.updateItemsPerPage(e)},document.querySelector(o.identifiers.changeLanguageSelect).onchange=function(e){o.updateRecordLanguage(e)},document.querySelector(o.identifiers.courseListTableBody).addEventListener("click",o.toggleCourseSelection)},toggleAllCoursesSelect:function(e){var i,t=document.querySelectorAll(".js-in2studyfinder-select-course"),n=e.target;i=n.checked?1:0,t.forEach(function(e){var t=e.getAttribute("data-in2studyfinder-course-uid");0===i&&e.checked&&t&&o.removeCourseFromList(t),1!==i||e.checked||t&&o.addCourseToList(t),e.checked=i}),o.updateSelectedCoursesCount()},prepareSelectedCourses:function(){0<o.coursesList.length&&o.coursesList.forEach(function(e){var t=document.querySelector("#course-"+e);null!==t&&(t.checked=1)})},updateItemsPerPage:function(e){var t=e.target.selectedOptions[0].getAttribute("data-action");void 0!==t&&o.paginationAjaxCall(t)},updateRecordLanguage:function(e){var t=e.target.selectedOptions[0].getAttribute("data-action");void 0!==t&&o.resetCourseList()&&o.paginationAjaxCall(t)},callPagination:function(e){e.preventDefault();var t=e.target.href,i=document.querySelector(".js-in2studyfinder-itemsPerPage").value;void 0!==t&&(t=r.addAttributeToUrl(t,"tx_in2studyfinder_web_in2studyfinderm1[@widget_0][itemsPerPage]",i),o.paginationAjaxCall(t))},paginationAjaxCall:function(e){t.ajaxCall(e,o.onPaginationCallStart,o.onPaginationCallSuccess)},onPaginationCallStart:function(){n.toggleClassForElement(document.querySelector(o.identifiers.loader),o.identifiers.loaderActive)},onPaginationCallSuccess:function(e){var t=document.createElement("div"),i="js-in2studyfinder-select-course-container";t.innerHTML=e.responseText,document.querySelector("."+i).innerHTML=t.querySelector("."+i).innerHTML,o.initialize(),o.updateSelectedCoursesCount(),n.toggleClassForElement(document.querySelector(o.identifiers.loader),o.identifiers.loaderActive)},toggleCourseSelection:function(e){var t=e.target;t.classList.contains("js-in2studyfinder-select-course")&&(t.checked?o.addCourseToList(t.value):o.removeCourseFromList(t.value),o.updateSelectedCoursesCount())},addCourseToList:function(e){o.coursesList.push(e)},removeCourseFromList:function(e){o.coursesList.pop(e)},updateSelectedCoursesCount:function(){document.querySelector(".js-in2studyfinder-selected-courses-count").innerHTML=o.coursesList.length},getCourseList:function(){return o.coursesList},preparePagination:function(){var e=document.querySelector(o.identifiers.paginationContainer);document.querySelector(".js-in2studyfinder-pagination").appendChild(e)},resetCourseList:function(){var e=!0;return 0<o.coursesList.length&&(confirm("all currently selected courses will be deselected. Will you proceed?")?(o.coursesList=[],o.updateSelectedCoursesCount()):e=!1),e}};return o});