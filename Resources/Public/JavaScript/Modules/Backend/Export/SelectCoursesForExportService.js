define(["TYPO3/CMS/In2studyfinder/Utility/UiUtility","TYPO3/CMS/In2studyfinder/Utility/AjaxUtility","TYPO3/CMS/In2studyfinder/Utility/UrlUtility"],function(e,t,n){"use strict";var i={coursesList:[],identifiers:{checkAllCheckbox:".js-in2studyfinder-check-all",paginationContainer:".js-in2studyfinder-pagebrowser",itemsPerPageSelect:".js-in2studyfinder-itemsPerPage",changeLanguageSelect:".js-in2studyfinder-recordLanguage",courseListTableBody:".js-in2studyfinder-course-list",loader:".in2js-in2studyfinder-loader",loaderActive:".in2js-in2studyfinder-loader--active"}};return i.initialize=function(){i.preparePagination(),i.prepareSelectedCourses(),i.addEventListener()},i.addEventListener=function(){var e=document.querySelector(i.identifiers.checkAllCheckbox);e.addEventListener("click",i.toggleAllCoursesSelect);var t=document.querySelector(i.identifiers.paginationContainer);t.addEventListener("click",i.callPagination);var n=document.querySelector(i.identifiers.itemsPerPageSelect);n.onchange=function(e){i.updateItemsPerPage(e)};var r=document.querySelector(i.identifiers.changeLanguageSelect);r.onchange=function(e){i.updateRecordLanguage(e)};var o=document.querySelector(i.identifiers.courseListTableBody);o.addEventListener("click",i.toggleCourseSelection)},i.toggleAllCoursesSelect=function(e){var t,n=document.querySelectorAll(".js-in2studyfinder-select-course"),r=e.target;t=r.checked?1:0,n.forEach(function(e){var n=e.getAttribute("data-in2studyfinder-course-uid");0===t&&e.checked&&n&&i.removeCourseFromList(n),1!==t||e.checked||n&&i.addCourseToList(n),e.checked=t}),i.updateSelectedCoursesCount()},i.prepareSelectedCourses=function(){var e=i.coursesList;e.length>0&&i.coursesList.forEach(function(e){var t=document.querySelector("#course-"+e);null!==t&&(t.checked=1)})},i.updateItemsPerPage=function(e){var t=e.target.selectedOptions,n=t[0].getAttribute("data-action");"undefined"!=typeof n&&i.paginationAjaxCall(n)},i.updateRecordLanguage=function(e){var t=e.target.selectedOptions,n=t[0].getAttribute("data-action");"undefined"!=typeof n&&i.resetCourseList()&&i.paginationAjaxCall(n)},i.callPagination=function(e){e.preventDefault();var t=e.target.href,r=document.querySelector(".js-in2studyfinder-itemsPerPage").value;"undefined"!=typeof t&&(t=n.addAttributeToUrl(t,"tx_in2studyfinder_web_in2studyfinderm1[@widget_0][itemsPerPage]",r),i.paginationAjaxCall(t))},i.paginationAjaxCall=function(e){t.ajaxCall(e,i.onPaginationCallStart,i.onPaginationCallSuccess)},i.onPaginationCallStart=function(){e.toggleClassForElement(document.querySelector(i.identifiers.loader),i.identifiers.loaderActive)},i.onPaginationCallSuccess=function(t){var n=document.createElement("div"),r="js-in2studyfinder-select-course-container";n.innerHTML=t.responseText,document.querySelector("."+r).innerHTML=n.querySelector("."+r).innerHTML,i.initialize(),i.updateSelectedCoursesCount(),e.toggleClassForElement(document.querySelector(i.identifiers.loader),i.identifiers.loaderActive)},i.toggleCourseSelection=function(e){var t=e.target;t.classList.contains("js-in2studyfinder-select-course")&&(t.checked?i.addCourseToList(t.value):i.removeCourseFromList(t.value),i.updateSelectedCoursesCount())},i.addCourseToList=function(e){i.coursesList.push(e)},i.removeCourseFromList=function(e){i.coursesList.pop(e)},i.updateSelectedCoursesCount=function(){var e=document.querySelector(".js-in2studyfinder-selected-courses-count");e.innerHTML=i.coursesList.length},i.getCourseList=function(){return i.coursesList},i.preparePagination=function(){var e=document.querySelector(i.identifiers.paginationContainer);document.querySelector(".js-in2studyfinder-pagination").appendChild(e)},i.resetCourseList=function(){var e=!0;return i.coursesList.length>0&&(confirm("all currently selected courses will be deselected. Will you proceed?")?(i.coursesList=[],i.updateSelectedCoursesCount()):e=!1),e},i.initialize(),i});