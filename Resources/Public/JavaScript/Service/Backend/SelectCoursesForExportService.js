define(["TYPO3/CMS/In2studyfinder/Utility/UiUtility","TYPO3/CMS/In2studyfinder/Utility/AjaxUtility","TYPO3/CMS/In2studyfinder/Utility/UrlUtility"],function(e,t,n){"use strict";var r={coursesList:[]};return r.initialize=function(){r.preparePagination(),r.prepareSelectedCourses(),r.addEventListener()},r.addEventListener=function(){var e=document.querySelector(".js-in2studyfinder-check-all");e.addEventListener("click",r.toggleAllCoursesSelect);var t=document.querySelector(".js-in2studyfinder-pagebrowser");t.addEventListener("click",r.callPagination);var n=document.querySelector(".js-in2studyfinder-itemsPerPage");n.onchange=function(e){r.updateItemsPerPage(e)};var i=document.querySelector(".js-in2studyfinder-recordLanguage");i.onchange=function(e){r.updateRecordLanguage(e)};var o=document.querySelector(".js-in2studyfinder-course-list");o.addEventListener("click",r.toggleCourseSelection)},r.toggleAllCoursesSelect=function(e){var t,n=document.querySelectorAll(".js-in2studyfinder-select-course"),i=e.target;t=i.checked?1:0,n.forEach(function(e){var n=e.getAttribute("data-in2studyfinder-course-uid");0===t&&e.checked&&n&&r.removeCourseFromList(n),1!==t||e.checked||n&&r.addCourseToList(n),e.checked=t}),r.updateSelectedCoursesCount()},r.prepareSelectedCourses=function(){var e=r.coursesList;e.length>0&&r.coursesList.forEach(function(e){var t=document.querySelector("#course-"+e);null!==t&&(t.checked=1)})},r.updateItemsPerPage=function(e){var t=e.target.selectedOptions,n=t[0].getAttribute("data-action");"undefined"!=typeof n&&r.paginationAjaxCall(n)},r.updateRecordLanguage=function(e){var t=e.target.selectedOptions,n=t[0].getAttribute("data-action");"undefined"!=typeof n&&r.resetCourseList()&&r.paginationAjaxCall(n)},r.callPagination=function(e){e.preventDefault();var t=e.target.href,i=document.querySelector(".js-in2studyfinder-itemsPerPage").value;"undefined"!=typeof t&&(t=n.addAttributeToUrl(t,"tx_in2studyfinder_web_in2studyfinderm1[@widget_0][itemsPerPage]",i),r.paginationAjaxCall(t))},r.paginationAjaxCall=function(e){t.ajaxCall(e,r.onPaginationCallStart,r.onPaginationCallSuccess)},r.onPaginationCallStart=function(){e.toggleClassForElement(document.querySelector(".in2js-in2studyfinder-loader"),"in2studyfinder-loader--active")},r.onPaginationCallSuccess=function(t){var n=document.createElement("div"),i="js-in2studyfinder-select-course-container";n.innerHTML=t.responseText,document.querySelector("."+i).innerHTML=n.querySelector("."+i).innerHTML,r.initialize(),r.updateSelectedCoursesCount(),e.toggleClassForElement(document.querySelector(".in2js-in2studyfinder-loader"),"in2studyfinder-loader--active")},r.toggleCourseSelection=function(e){var t=e.target;t.classList.contains("js-in2studyfinder-select-course")&&(t.checked?r.addCourseToList(t.value):r.removeCourseFromList(t.value),r.updateSelectedCoursesCount())},r.addCourseToList=function(e){r.coursesList.push(e)},r.removeCourseFromList=function(e){r.coursesList.pop(e)},r.updateSelectedCoursesCount=function(){var e=document.querySelector(".js-in2studyfinder-selected-courses-count");e.innerHTML=r.coursesList.length},r.getCourseList=function(){return r.coursesList},r.preparePagination=function(){var e=document.querySelector(".js-in2studyfinder-pagebrowser");document.querySelector(".js-in2studyfinder-pagination").appendChild(e)},r.resetCourseList=function(){var e=!0;return r.coursesList.length>0&&(confirm("all currently selected courses will be deselected. Will you proceed?")?(r.coursesList=[],r.updateSelectedCoursesCount()):e=!1),e},r.initialize(),r});